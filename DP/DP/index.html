<!-- build time:Fri Sep 15 2023 15:18:09 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="http://lovearrowshoot.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" href="http://lovearrowshoot.github.io/atom.xml"><link rel="alternate" type="application/json" href="http://lovearrowshoot.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="设计模式"><link rel="canonical" href="http://lovearrowshoot.github.io/DP/DP/"><title>设计模式详解 - 设计模式 | umiの道場 = = ❤Love Arrow Shoot!❤</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">设计模式详解</h1><div class="meta"><span class="item" title="创建时间：2023-06-30 15:08:06"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-06-30T15:08:06+08:00">2023-06-30</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>28k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>26 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">umiの道場</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/155Sonoda-Umi-水上アスレチックで決めましょう-UR-lfhDK8.png"></li><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/292SR-Hoshizora-Rin-I-wanna-go-again-nya-Wonderful-Rush-4IFVge.png"></li><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/680SR-Tojo-Nozomi-Perfect-for-Cherry-Blossoms-Right-Bokura-wa-Ima-no-Naka-d-emL9yI.png"></li><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/806SR-Ayase-Eli-They-Taste-Amazing-Too-Mermaid-festa-vol-1-p3TI65.png"></li><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/446UR-Kousaka-Honoka-Zzz-zzz-Captain-Honoka-1zg6Le.png"></li><li class="item" data-background-image="https://umi-blog-delta.vercel.app/gh/LoveArrowShoot/image-bed@main/blog-img/355SR-Hoshizora-Rin-Mmm-so-good-Yume-no-Tobira-finrsl.png"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/DP/" itemprop="item" rel="index" title="分类于 设计模式"><span itemprop="name">设计模式</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://lovearrowshoot.github.io/DP/DP/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Umi"><meta itemprop="description" content="❤Love Arrow Shoot!❤, 这只是我闲着无聊搭的一个博客，主要用于存放笔记，顺便厨力放出"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><h1 id="六大原则"><a class="anchor" href="#六大原则">#</a> 六大原则</h1><h3 id="总原则开闭原则open-closed-principle"><a class="anchor" href="#总原则开闭原则open-closed-principle">#</a> 总原则 —— 开闭原则（Open Closed Principle）</h3><p>在程序需要进行拓展的时候，不能去修改原有的代码，而是要扩展原有代码，实现一个热插拔的效果。所以一句话概括就是：为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类等。</p><h3 id="1-单一职责原则single-responsibility-principle"><a class="anchor" href="#1-单一职责原则single-responsibility-principle">#</a> 1、单一职责原则（Single Responsibility Principle）</h3><p>一个类应该只有一个发生变化的原因。不要存在多于一个导致类变更的原因，也就是说每个类应该实现单一的职责，否则就应该把类拆分。</p><h3 id="2-里氏替换原则liskov-substitution-principle"><a class="anchor" href="#2-里氏替换原则liskov-substitution-principle">#</a> 2、里氏替换原则（Liskov Substitution Principle）</h3><p>所有引用基类的地方必须能透明地使用其子类的对象。</p><p>任何基类可以出现的地方，子类一定可以出现。里氏替换原则是继承复用的基石，只有当衍生类可以替换基类，软件单位的功能不受到影响时，基类才能真正被复用，而衍生类也能够在基类的基础上增加新的行为。</p><p>里氏代换原则是对 “开 - 闭” 原则的补充。实现 “开闭” 原则的关键步骤就是抽象化。而基类与子类的继承关系就是抽象化的具体实现，所以里氏替换原则是对实现抽象化的具体步骤的规范。里氏替换原则中，子类对父类的方法尽量不要重写和重载。因为父类代表了定义好的结构，通过这个规范的接口与外界交互，子类不应该随便破坏它。</p><h3 id="3-依赖倒置原则dependence-inversion-principle"><a class="anchor" href="#3-依赖倒置原则dependence-inversion-principle">#</a> 3、依赖倒置原则（Dependence Inversion Principle）</h3><p>1、上层模块不应该依赖底层模块，它们都应该依赖于抽象。<br>2、抽象不应该依赖于细节，细节应该依赖于抽象。</p><p>面向接口编程，依赖于抽象而不依赖于具体。写代码时用到具体类时，不与具体类交互，而与具体类的上层接口交互。</p><h3 id="4-接口隔离原则interface-segregation-principle"><a class="anchor" href="#4-接口隔离原则interface-segregation-principle">#</a> 4、接口隔离原则（Interface Segregation Principle）</h3><p>1、客户端不应该依赖它不需要的接口。<br>2、类间的依赖关系应该建立在最小的接口上。</p><p>每个接口中不存在子类用不到却必须实现的方法，如果不然，就要将接口拆分。使用多个隔离的接口，比使用单个接口（多个接口方法集合到一个的接口）要好。</p><h3 id="5-迪米特法则最少知道原则law-of-demeter"><a class="anchor" href="#5-迪米特法则最少知道原则law-of-demeter">#</a> 5、迪米特法则（最少知道原则）(Law of Demeter)</h3><p>一个类对自己依赖的类知道的越少越好。无论被依赖的类多么复杂，都应该将逻辑封装在方法的内部，通过 public 方法提供给外部。这样当被依赖的类变化时，才能最小的影响该类。</p><p>最少知道原则的另一个表达方式是：只与直接的朋友通信。类之间只要有耦合关系，就叫朋友关系。耦合分为依赖、关联、聚合、组合等。我们称出现为成员变量、方法参数、方法返回值中的类为直接朋友。局部变量、临时变量则不是直接的朋友。我们要求陌生的类不要作为局部变量出现在类中。</p><h3 id="6-合成复用原则composite-reuse-principle"><a class="anchor" href="#6-合成复用原则composite-reuse-principle">#</a> 6、合成复用原则（Composite Reuse Principle）</h3><p>尽量使用对象组合 / 聚合，而不是继承关系达到软件复用的目的。<br>合成或聚合可以将已有对象纳入到新对象中，使之成为新对象的一部分，因此新对象可以调用已有对象的功能。</p><h1 id="创建型模式"><a class="anchor" href="#创建型模式">#</a> 创建型模式</h1><h2 id="工厂方法"><a class="anchor" href="#工厂方法">#</a> 工厂方法</h2><p>工厂方法模式，是指定义一个用于创建对象的接口，让子类决定实例化哪一个类。使一个类的实例化延迟到其子类。</p><p><img data-src="38b89bfd5d5f55e2e608954b4b30f58c.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCore</span>    </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 单核 A    </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCoreA</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">SingleCore</span></span>    </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"SingleCore A"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 单核 B    </span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCoreB</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">SingleCore</span></span>    </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"SingleCore B"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Factory</span>    </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">virtual</span> SingleCore<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// 生产 A 核的工厂    </span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FactoryA</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Factory</span></span>    </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="27"></td><td><pre>    SingleCoreA<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> SingleCoreA<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 生产 B 核的工厂    </span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FactoryB</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Factory</span></span>    </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="33"></td><td><pre>    SingleCoreB<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> SingleCoreB<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="抽象工厂"><a class="anchor" href="#抽象工厂">#</a> 抽象工厂</h2><p>抽象工厂模式为提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。</p><p><img data-src="b9b01dae250d230f8e91f95f1fe2f2c6.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 单核    </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCore</span>     </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCoreA</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">SingleCore</span></span>      </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Single Core A"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingleCoreB</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">SingleCore</span></span>    </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Single Core B"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// 多核    </span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MultiCore</span>      </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MultiCoreA</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">MultiCore</span></span>      </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Multi Core A"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="27"></td><td><pre>    </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MultiCoreB</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">MultiCore</span></span>      </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Multi Core B"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">// 工厂    </span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">CoreFactory</span>      </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">virtual</span> SingleCore<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">virtual</span> MultiCore<span class="token operator">*</span> <span class="token function">CreateMultiCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 工厂 A，专门用来生产 A 型号的处理器    </span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FactoryA</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CoreFactory</span></span>    </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="45"></td><td><pre>    SingleCore<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">SingleCoreA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="46"></td><td><pre>    MultiCore<span class="token operator">*</span> <span class="token function">CreateMultiCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">MultiCoreA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    </pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment">// 工厂 B，专门用来生产 B 型号的处理器    </span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FactoryB</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CoreFactory</span></span>    </pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>    </pre></td></tr><tr><td data-num="52"></td><td><pre>    SingleCore<span class="token operator">*</span> <span class="token function">CreateSingleCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">SingleCoreB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="53"></td><td><pre>    MultiCore<span class="token operator">*</span> <span class="token function">CreateMultiCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">MultiCoreB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    </pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id="建造者"><a class="anchor" href="#建造者">#</a> 建造者</h2><p>建造者是一种创建型设计模式，使你能够分步骤创建复杂对象。该模式允许你使用相同的创建代码生成不同类型和形式的对象。</p><p><img data-src="3687615a19a7c11839c5a7fb034356d1.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Builder</span>    </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildLeftArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildRightArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildLeftLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">BuildRightLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 构造瘦人  </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ThinBuilder</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Builder</span></span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin body"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin head"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildLeftArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin leftarm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildRightArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin rightarm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildLeftLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin leftleg"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildRightLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build thin rightleg"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// 构造胖人  </span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FatBuilder</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Builder</span></span>  </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat body"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat head"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildLeftArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat leftarm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildRightArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat rightarm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildLeftLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat leftleg"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">BuildRightLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"build fat rightleg"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">// 构造的指挥官  </span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Director</span>    </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>    Builder <span class="token operator">*</span>m_pBuilder<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token function">Director</span><span class="token punctuation">(</span>Builder <span class="token operator">*</span>builder<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_pBuilder <span class="token operator">=</span> builder<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildLeftArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildRightArm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildLeftLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>        m_pBuilder<span class="token operator">-></span><span class="token function">BuildRightLeg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre>    FatBuilder thin<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>    Director <span class="token function">director</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>thin<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre>    director<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="原型"><a class="anchor" href="#原型">#</a> 原型</h2><p>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p><p><img data-src="53749cfcba658417250cae5d69442256.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 父类  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Resume</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">Resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">virtual</span> Resume<span class="token operator">*</span> <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Set</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ResumeA</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Resume</span></span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 构造函数  </span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token keyword">const</span> ResumeA <span class="token operator">&amp;</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 拷贝构造函数  </span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token operator">~</span><span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 析构函数  </span></pre></td></tr><tr><td data-num="20"></td><td><pre>    ResumeA<span class="token operator">*</span> <span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 克隆，关键所在  </span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// 显示内容  </span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token class-name">ResumeA</span><span class="token double-colon punctuation">::</span><span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>        name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="27"></td><td><pre>        name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>        name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token function">strcpy</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token class-name">ResumeA</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token class-name">ResumeA</span><span class="token double-colon punctuation">::</span><span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token keyword">const</span> ResumeA <span class="token operator">&amp;</span>r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>    name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token function">strcpy</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> r<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>ResumeA<span class="token operator">*</span> <span class="token class-name">ResumeA</span><span class="token double-colon punctuation">::</span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">ResumeA</span><span class="token double-colon punctuation">::</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    cout<span class="token operator">&lt;&lt;</span><span class="token string">"ResumeA name : "</span><span class="token operator">&lt;&lt;</span>name<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token comment">//ResumeB 和 ResumeA 类似</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre>    Resume <span class="token operator">*</span>r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    Resume <span class="token operator">*</span>r2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ResumeB</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>    Resume <span class="token operator">*</span>r3 <span class="token operator">=</span> r1<span class="token operator">-></span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>    Resume <span class="token operator">*</span>r4 <span class="token operator">=</span> r2<span class="token operator">-></span><span class="token function">Clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre>    r1<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r2<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token comment">// 删除 r1,r2  </span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">delete</span> r1<span class="token punctuation">;</span> <span class="token keyword">delete</span> r2<span class="token punctuation">;</span>     </pre></td></tr><tr><td data-num="56"></td><td><pre>    r1 <span class="token operator">=</span> r2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">// 深拷贝所以对 r3,r4 无影响  </span></pre></td></tr><tr><td data-num="58"></td><td><pre>    r3<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r4<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">delete</span> r3<span class="token punctuation">;</span> <span class="token keyword">delete</span> r4<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre>    r3 <span class="token operator">=</span> r4 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="单例"><a class="anchor" href="#单例">#</a> 单例</h2><p>单例是一种创建型设计模式，让你能够保证一个类只有一个实例，并提供一个访问该实例的全局节点。</p><p>&lt;img src=&quot;aec7623b038bb26dc13f1cc0a7e6b90a.png&quot; alt=&quot;1691050997088.png&quot; style=&quot;zoom:50%;&quot; /&gt;</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//Singleton.h  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Singleton</span>    </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">static</span> Singleton<span class="token operator">*</span> <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">static</span> Singleton <span class="token operator">*</span>singleton<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//Singleton.cpp  </span></pre></td></tr><tr><td data-num="11"></td><td><pre>Singleton<span class="token operator">*</span> Singleton<span class="token double-colon punctuation">::</span>singleton <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre>Singleton<span class="token operator">*</span> <span class="token class-name">Singleton</span><span class="token double-colon punctuation">::</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>singleton <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>        singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//Singleton 存在子类</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//Singleton.h  </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once  </span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span>  </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Singleton</span>    </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">static</span> Singleton<span class="token operator">*</span> <span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span> <span class="token comment">// 必须为保护，如果是私有属性，子类无法访问父类的构造函数  </span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">static</span> Singleton <span class="token operator">*</span>singleton<span class="token punctuation">;</span> <span class="token comment">// 唯一实例的指针  </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">//Singleton.cpp  </span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Singleton.h"</span>  </span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SingletonA.h"</span>  </span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SingletonB.h"</span>  </span></pre></td></tr><tr><td data-num="23"></td><td><pre>Singleton<span class="token operator">*</span> Singleton<span class="token double-colon punctuation">::</span>singleton <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>Singleton<span class="token operator">*</span> <span class="token class-name">Singleton</span><span class="token double-colon punctuation">::</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>singleton <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"SingletonA"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>            singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">SingletonA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">"SingletonB"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>            singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">SingletonB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">else</span>   </pre></td></tr><tr><td data-num="33"></td><td><pre>            singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">//SingletonA.h  </span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once  </span></span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Singleton.h"</span>  </span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingletonA</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Singleton</span></span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span><span class="token punctuation">;</span> <span class="token comment">// 必须为友元类，否则父类无法访问子类的构造函数  </span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"SingletonA"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>   <span class="token comment">// 为保护属性，这样外界无法通过构造函数进行实例化  </span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token function">SingletonA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">//SingletonB.h  </span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once  </span></span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Singleton.h"</span>  </span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SingletonB</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Singleton</span></span>  </pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span><span class="token punctuation">;</span> <span class="token comment">// 必须为友元类，否则父类无法访问子类的构造函数  </span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"SingletonB"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  <span class="token comment">// 为保护属性，这样外界无法通过构造函数进行实例化  </span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token function">SingletonB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="结构型模式"><a class="anchor" href="#结构型模式">#</a> 结构型模式</h1><h2 id="适配器"><a class="anchor" href="#适配器">#</a> 适配器</h2><p>适配器模式将一个类的接口转换成客户希望的另外一个接口，使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p><p>举个例子，在 STL 中就用到了适配器模式。STL 实现了一种数据结构，称为双端队列，支持前后两段的插入与删除。STL 实现栈和队列时，没有从头开始定义它们，而是直接使用双端队列实现的。这里双端队列就扮演了适配器的角色。队列用到了它的后端插入，前端删除。而栈用到了它的后端插入，后端删除。</p><p><img data-src="3bbb09968305c9eef7c878abe0b34046.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 双端队列  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Deque</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Deque push_back"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">push_front</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Deque push_front"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Deque pop_back"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Deque pop_front"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 顺序容器  </span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Sequence</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// 栈  </span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Stack</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Sequence</span></span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> deque<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> deque<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    Deque deque<span class="token punctuation">;</span> <span class="token comment">// 双端队列  </span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 队列  </span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Queue</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Sequence</span></span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> deque<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> deque<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>    Deque deque<span class="token punctuation">;</span> <span class="token comment">// 双端队列  </span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    Sequence <span class="token operator">*</span>s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    Sequence <span class="token operator">*</span>s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>    s1<span class="token operator">-></span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s1<span class="token operator">-></span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>    s2<span class="token operator">-></span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s2<span class="token operator">-></span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">delete</span> s1<span class="token punctuation">;</span> <span class="token keyword">delete</span> s2<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="桥接"><a class="anchor" href="#桥接">#</a> 桥接</h2><p>桥接是一种结构型设计模式，可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构，从而能在开发时分别使用</p><p><img data-src="1b2960edb3c6045e27d9b9cdb3b87260.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 操作系统  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">OS</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">WindowOS</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">OS</span></span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"安装Window操作系统"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">LinuxOS</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">OS</span></span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"安装Linux操作系统"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">UnixOS</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">OS</span></span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"安装Unix操作系统"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// 计算机  </span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Computer</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">InstallOS</span><span class="token punctuation">(</span>OS <span class="token operator">*</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DellComputer</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Computer</span></span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS</span><span class="token punctuation">(</span>OS <span class="token operator">*</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> os<span class="token operator">-></span><span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AppleComputer</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Computer</span></span>  </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS</span><span class="token punctuation">(</span>OS <span class="token operator">*</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> os<span class="token operator">-></span><span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">HPComputer</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Computer</span></span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">InstallOS</span><span class="token punctuation">(</span>OS <span class="token operator">*</span>os<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> os<span class="token operator">-></span><span class="token function">InstallOS_Imp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>    OS <span class="token operator">*</span>os1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">WindowOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>    OS <span class="token operator">*</span>os2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">LinuxOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre>    Computer <span class="token operator">*</span>computer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">AppleComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    computer1<span class="token operator">-></span><span class="token function">InstallOS</span><span class="token punctuation">(</span>os1<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>    computer1<span class="token operator">-></span><span class="token function">InstallOS</span><span class="token punctuation">(</span>os2<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="组合"><a class="anchor" href="#组合">#</a> 组合</h2><p>组合是一种结构型设计模式，你可以使用它将对象组合成树状结构，并且能像使用独立对象一样使用它们。</p><p>比如一个集团公司，它有一个母公司，下设很多家子公司。不管是母公司还是子公司，都有各自直属的财务部、人力资源部、销售部等。对于母公司来说，不论是子公司，还是直属的财务部、人力资源部，都是它的部门。整个公司的部门拓扑图就是一个树形结构。</p><p><img data-src="cf8abfe18471cc0593c697bede182c65.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Company</span>    </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token function">Company</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Company</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>Company <span class="token operator">*</span>pCom<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    string m_name<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 具体公司  </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ConcreteCompany</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Company</span></span>    </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function">ConcreteCompany</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">Company</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">ConcreteCompany</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Add</span><span class="token punctuation">(</span>Company <span class="token operator">*</span>pCom<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_listCompany<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>pCom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 位于树的中间，可以增加子树  </span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> depth<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"-"</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>        list<span class="token operator">&lt;</span>Company <span class="token operator">*</span><span class="token operator">></span><span class="token double-colon punctuation">::</span>iterator iter<span class="token operator">=</span>m_listCompany<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> iter <span class="token operator">!=</span> m_listCompany<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 显示下层结点  </span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span>depth <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    list<span class="token operator">&lt;</span>Company <span class="token operator">*</span><span class="token operator">></span> m_listCompany<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">// 具体的部门，财务部  </span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FinanceDepartment</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Company</span></span>   </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token function">FinanceDepartment</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Company</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">FinanceDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span> <span class="token comment">// 只需显示，无限添加函数，因为已是叶结点  </span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> depth<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"-"</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token comment">// 具体的部门，人力资源部  </span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">HRDepartment</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Company</span></span>    </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token function">HRDepartment</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Company</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">HRDepartment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span> <span class="token comment">// 只需显示，无限添加函数，因为已是叶结点  </span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> depth<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"-"</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre>    Company <span class="token operator">*</span>root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteCompany</span><span class="token punctuation">(</span><span class="token string">"总公司"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre>    Company <span class="token operator">*</span>leaf1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">FinanceDepartment</span><span class="token punctuation">(</span><span class="token string">"财务部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>    Company <span class="token operator">*</span>leaf2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">HRDepartment</span><span class="token punctuation">(</span><span class="token string">"人力资源部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>    root<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf1<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre>    root<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf2<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">// 分公司 A  </span></pre></td></tr><tr><td data-num="67"></td><td><pre>    Company <span class="token operator">*</span>mid1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteCompany</span><span class="token punctuation">(</span><span class="token string">"分公司A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre>    Company <span class="token operator">*</span>leaf3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">FinanceDepartment</span><span class="token punctuation">(</span><span class="token string">"财务部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre>    Company <span class="token operator">*</span>leaf4<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">HRDepartment</span><span class="token punctuation">(</span><span class="token string">"人力资源部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="70"></td><td><pre>    mid1<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf3<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="71"></td><td><pre>    mid1<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf4<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="72"></td><td><pre>    root<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>mid1<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token comment">// 分公司 B  </span></pre></td></tr><tr><td data-num="74"></td><td><pre>    Company <span class="token operator">*</span>mid2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">ConcreteCompany</span><span class="token punctuation">(</span><span class="token string">"分公司B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="75"></td><td><pre>    FinanceDepartment <span class="token operator">*</span>leaf5<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">FinanceDepartment</span><span class="token punctuation">(</span><span class="token string">"财务部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="76"></td><td><pre>    HRDepartment <span class="token operator">*</span>leaf6<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">HRDepartment</span><span class="token punctuation">(</span><span class="token string">"人力资源部"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="77"></td><td><pre>    mid2<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf5<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="78"></td><td><pre>    mid2<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>leaf6<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="79"></td><td><pre>    root<span class="token operator">-></span><span class="token function">Add</span><span class="token punctuation">(</span>mid2<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="80"></td><td><pre>    root<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="81"></td><td><pre>  </pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token keyword">delete</span> leaf1<span class="token punctuation">;</span> <span class="token keyword">delete</span> leaf2<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token keyword">delete</span> leaf3<span class="token punctuation">;</span> <span class="token keyword">delete</span> leaf4<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token keyword">delete</span> leaf5<span class="token punctuation">;</span> <span class="token keyword">delete</span> leaf6<span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token keyword">delete</span> mid1<span class="token punctuation">;</span> <span class="token keyword">delete</span> mid2<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token keyword">delete</span> root<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="装饰"><a class="anchor" href="#装饰">#</a> 装饰</h2><p>装饰是一种结构型设计模式，允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为，动态地给一个对象添加一些额外的职责。就增加功能来说，装饰模式相比生成子类更为灵活。有时我们希望给某个对象而不是整个类添加一些功能。</p><p><img data-src="5ed9eaae83dcd93f591b22535a75d622.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 公共抽象类  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Phone</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">Phone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Phone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 具体的手机类  </span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">iPhone</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Phone</span></span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    string m_name<span class="token punctuation">;</span> <span class="token comment">// 手机名称  </span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">iPhone</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token operator">~</span><span class="token function">iPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"的装饰"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 具体的手机类  </span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">NokiaPhone</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Phone</span></span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    string m_name<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token function">NokiaPhone</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token operator">~</span><span class="token function">NokiaPhone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"的装饰"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">// 装饰类  </span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DecoratorPhone</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Phone</span></span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    Phone <span class="token operator">*</span>m_phone<span class="token punctuation">;</span>  <span class="token comment">// 要装饰的手机  </span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token function">DecoratorPhone</span><span class="token punctuation">(</span>Phone <span class="token operator">*</span>phone<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_phone</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_phone<span class="token operator">-></span><span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// 具体的装饰类  </span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DecoratorPhoneA</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">DecoratorPhone</span></span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token function">DecoratorPhoneA</span><span class="token punctuation">(</span>Phone <span class="token operator">*</span>phone<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">DecoratorPhone</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">DecoratorPhone</span><span class="token double-colon punctuation">::</span><span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">AddDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">AddDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"增加挂件"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 增加的装饰  </span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// 具体的装饰类  </span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DecoratorPhoneB</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">DecoratorPhone</span></span>  </pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token function">DecoratorPhoneB</span><span class="token punctuation">(</span>Phone <span class="token operator">*</span>phone<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">DecoratorPhone</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">DecoratorPhone</span><span class="token double-colon punctuation">::</span><span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">AddDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">AddDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"屏幕贴膜"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 增加的装饰  </span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>    Phone <span class="token operator">*</span>iphone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">NokiaPhone</span><span class="token punctuation">(</span><span class="token string">"6300"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>    Phone <span class="token operator">*</span>dpa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DecoratorPhoneA</span><span class="token punctuation">(</span>iphone<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 装饰，增加挂件  </span></pre></td></tr><tr><td data-num="64"></td><td><pre>    Phone <span class="token operator">*</span>dpb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">DecoratorPhoneB</span><span class="token punctuation">(</span>dpa<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 装饰，屏幕贴膜  </span></pre></td></tr><tr><td data-num="65"></td><td><pre>    dpb<span class="token operator">-></span><span class="token function">ShowDecorate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token keyword">delete</span> dpa<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token keyword">delete</span> dpb<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">delete</span> iphone<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>装饰模式提供了更加灵活的向对象添加职责的方式。可以用添加和分离的方法，用装饰在运行时刻增加和删除职责。装饰模式提供了一种 “即用即付” 的方法来添加职责。它并不试图在一个复杂的可定制的类中支持所有可预见的特征，相反，你可以定义一个简单的类，并且用装饰类给它逐渐地添加功能。可以从简单的部件组合出复杂的功能</p><h2 id="外观"><a class="anchor" href="#外观">#</a> 外观</h2><p>为子系统中的一组接口提供一个一致的界面， 外观模式定义了一个高层接口，这个接口使得这一子系统更加容易使用</p><p><img data-src="96c435a961c25546b54d938359b9ac86.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Scanner</span>  </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"词法分析"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Parser</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"语法分析"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">GenMidCode</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">GenCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"产生中间代码"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">GenMachineCode</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">GenCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"产生机器码"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">// 高层接口  </span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Compiler</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>        Scanner scanner<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>        Parser parser<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>        GenMidCode genMidCode<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>        GenMachineCode genMacCode<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>        scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>        parser<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>        genMidCode<span class="token punctuation">.</span><span class="token function">GenCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>        genMacCode<span class="token punctuation">.</span><span class="token function">GenCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>    Compiler compiler<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>    Console <span class="token function">Compiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="享元"><a class="anchor" href="#享元">#</a> 享元</h2><p>享元是一种结构型设计模式，它摒弃了在每个对象中保存所有数据的方式，通过共享多个对象所共有的相同状态，让你能在有限的内存容量中载入更多对象。</p><p>在围棋中，棋子就是大量细粒度的对象。其属性有内在的，比如颜色、形状等，也有外在的，比如在棋盘上的位置。内在的属性是可以共享的，区分在于外在属性。因此，可以这样设计，只需定义两个棋子的对象，一颗黑棋和一颗白棋，这两个对象含棋子的内在属性；棋子的外在属性，即在棋盘上的位置可以提取出来作为一个结构，存放在单独的容器中。相比之前的方案，现在容器中仅仅存放了位置属性，而原来则是棋子对象。显然，现在的方案大大减少了对于空间的需求。</p><p><img data-src="0caf31a5acaedd36e0d83b93e75ca6ae.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 棋子颜色  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">enum</span> <span class="token class-name">PieceColor</span> <span class="token punctuation">&#123;</span>BLACK<span class="token punctuation">,</span> WHITE<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 棋子位置  </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">PiecePos</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">int</span> x<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">int</span> y<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">PiecePos</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 棋子定义  </span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Piece</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    PieceColor m_color<span class="token punctuation">;</span> <span class="token comment">// 颜色  </span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">Piece</span><span class="token punctuation">(</span>PieceColor color<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_color</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token operator">~</span><span class="token function">Piece</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BlackPiece</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Piece</span></span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">BlackPiece</span><span class="token punctuation">(</span>PieceColor color<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">Piece</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token operator">~</span><span class="token function">BlackPiece</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"绘制一颗黑棋\n"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">WhitePiece</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Piece</span></span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token function">WhitePiece</span><span class="token punctuation">(</span>PieceColor color<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">Piece</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token operator">~</span><span class="token function">WhitePiece</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"绘制一颗白棋\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">PieceBoard</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    vector<span class="token operator">&lt;</span>PiecePos<span class="token operator">></span> m_vecPos<span class="token punctuation">;</span> <span class="token comment">// 存放棋子的位置  </span></pre></td></tr><tr><td data-num="39"></td><td><pre>    Piece <span class="token operator">*</span>m_blackPiece<span class="token punctuation">;</span>       <span class="token comment">// 黑棋棋子   </span></pre></td></tr><tr><td data-num="40"></td><td><pre>    Piece <span class="token operator">*</span>m_whitePiece<span class="token punctuation">;</span>       <span class="token comment">// 白棋棋子  </span></pre></td></tr><tr><td data-num="41"></td><td><pre>    string m_blackName<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>    string m_whiteName<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token function">PieceBoard</span><span class="token punctuation">(</span>string black<span class="token punctuation">,</span> string white<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_blackName</span><span class="token punctuation">(</span>black<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_whiteName</span><span class="token punctuation">(</span>white<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>        m_blackPiece <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>        m_whitePiece <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token operator">~</span><span class="token function">PieceBoard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> m_blackPiece<span class="token punctuation">;</span> <span class="token keyword">delete</span> m_whitePiece<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetPiece</span><span class="token punctuation">(</span>PieceColor color<span class="token punctuation">,</span> PiecePos pos<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>color <span class="token operator">==</span> BLACK<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>m_blackPiece <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  <span class="token comment">// 只有一颗黑棋  </span></pre></td></tr><tr><td data-num="55"></td><td><pre>                m_blackPiece <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BlackPiece</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>     </pre></td></tr><tr><td data-num="56"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span>m_blackName<span class="token operator">&lt;&lt;</span><span class="token string">"在位置("</span><span class="token operator">&lt;&lt;</span>pos<span class="token punctuation">.</span>x<span class="token operator">&lt;&lt;</span><span class="token char">','</span><span class="token operator">&lt;&lt;</span>pos<span class="token punctuation">.</span>y<span class="token operator">&lt;&lt;</span><span class="token string">")"</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre>            m_blackPiece<span class="token operator">-></span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>m_whitePiece <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>                m_whitePiece <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">WhitePiece</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span>m_whiteName<span class="token operator">&lt;&lt;</span><span class="token string">"在位置("</span><span class="token operator">&lt;&lt;</span>pos<span class="token punctuation">.</span>x<span class="token operator">&lt;&lt;</span><span class="token char">','</span><span class="token operator">&lt;&lt;</span>pos<span class="token punctuation">.</span>y<span class="token operator">&lt;&lt;</span><span class="token string">")"</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre>            m_whitePiece<span class="token operator">-></span><span class="token function">Draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>        m_vecPos<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="73"></td><td><pre>    PieceBoard <span class="token function">pieceBoard</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="74"></td><td><pre>    pieceBoard<span class="token punctuation">.</span><span class="token function">SetPiece</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">,</span> <span class="token function">PiecePos</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="75"></td><td><pre>    pieceBoard<span class="token punctuation">.</span><span class="token function">SetPiece</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">,</span> <span class="token function">PiecePos</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="76"></td><td><pre>    pieceBoard<span class="token punctuation">.</span><span class="token function">SetPiece</span><span class="token punctuation">(</span>BLACK<span class="token punctuation">,</span> <span class="token function">PiecePos</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="77"></td><td><pre>    pieceBoard<span class="token punctuation">.</span><span class="token function">SetPiece</span><span class="token punctuation">(</span>WHITE<span class="token punctuation">,</span> <span class="token function">PiecePos</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="代理"><a class="anchor" href="#代理">#</a> 代理</h2><p>代理是一种结构型设计模式，让你能够提供对象的替代品　或其占位符。代理控制着对于原对象的访问，并允许在将请求提交给对象前后进行一些处理。</p><p>考虑一个可以在文档中嵌入图形对象的文档编辑器。有些图形对象的创建开销很大。但是打开文档必须很迅速，因此我们在打开文档时应避免一次性创建所有开销很大的对象。这里就可以运用代理模式，在打开文档时，并不打开图形对象，而是打开图形对象的代理以替代真实的图形。待到真正需要打开图形时，仍由代理负责打开。</p><p><img data-src="e40525f48080adb11d10aeb26b637836.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Image</span>  </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token function">Image</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_imageName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    string m_imageName<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BigImage</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Image</span></span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">BigImage</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Image</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token operator">~</span><span class="token function">BigImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Show big image : "</span><span class="token operator">&lt;&lt;</span>m_imageName<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BigImageProxy</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Image</span></span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>    BigImage <span class="token operator">*</span>m_bigImage<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token function">BigImageProxy</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Image</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_bigImage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token operator">~</span><span class="token function">BigImageProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> m_bigImage<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>m_bigImage <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>            m_bigImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BigImage</span><span class="token punctuation">(</span>m_imageName<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>        m_bigImage<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    Image <span class="token operator">*</span>image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BigImageProxy</span><span class="token punctuation">(</span><span class="token string">"proxy.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 代理  </span></pre></td></tr><tr><td data-num="36"></td><td><pre>    image<span class="token operator">-></span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要时由代理负责打开  </span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">delete</span> image<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h1 id="行为模式"><a class="anchor" href="#行为模式">#</a> 行为模式</h1><h2 id="责任链"><a class="anchor" href="#责任链">#</a> 责任链</h2><p>责任链模式：使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。其思想很简单，考虑员工要求加薪。公司的管理者一共有三级，总经理、总监、经理，如果一个员工要求加薪，应该向主管的经理申请，如果加薪的数量在经理的职权内，那么经理可以直接批准，否则将申请上交给总监。总监的处理方式也一样，总经理可以处理所有请求。</p><p><img data-src="64e6fb9ed593692210e06621bd4a6243.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 抽象管理者  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Manager</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    Manager <span class="token operator">*</span>m_manager<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    string m_name<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">Manager</span><span class="token punctuation">(</span>Manager <span class="token operator">*</span>manager<span class="token punctuation">,</span> string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">m_manager</span><span class="token punctuation">(</span>manager<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">DealWithRequest</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 经理  </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">CommonManager</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Manager</span></span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function">CommonManager</span><span class="token punctuation">(</span>Manager <span class="token operator">*</span>manager<span class="token punctuation">,</span> string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Manager</span><span class="token punctuation">(</span>manager<span class="token punctuation">,</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">DealWithRequest</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment">// 经理职权之内  </span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"经理"</span><span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"批准"</span><span class="token operator">&lt;&lt;</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"加薪"</span><span class="token operator">&lt;&lt;</span>num<span class="token operator">&lt;&lt;</span><span class="token string">"元"</span><span class="token operator">&lt;&lt;</span>endl<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"经理"</span><span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"无法处理，交由总监处理"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>            m_manager<span class="token operator">-></span><span class="token function">DealWithRequest</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 总监  </span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Majordomo</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Manager</span></span>  </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token function">Majordomo</span><span class="token punctuation">(</span>Manager <span class="token operator">*</span>manager<span class="token punctuation">,</span> string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Manager</span><span class="token punctuation">(</span>manager<span class="token punctuation">,</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">DealWithRequest</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token comment">// 总监职权之内  </span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"总监"</span><span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"批准"</span><span class="token operator">&lt;&lt;</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"加薪"</span><span class="token operator">&lt;&lt;</span>num<span class="token operator">&lt;&lt;</span><span class="token string">"元"</span><span class="token operator">&lt;&lt;</span>endl<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"总监"</span><span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"无法处理，交由总经理处理"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>            m_manager<span class="token operator">-></span><span class="token function">DealWithRequest</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">// 总经理  </span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">GeneralManager</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Manager</span></span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token function">GeneralManager</span><span class="token punctuation">(</span>Manager <span class="token operator">*</span>manager<span class="token punctuation">,</span> string name<span class="token punctuation">)</span><span class="token operator">:</span><span class="token function">Manager</span><span class="token punctuation">(</span>manager<span class="token punctuation">,</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">DealWithRequest</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>  <span class="token comment">// 总经理可以处理所有请求  </span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span><span class="token string">"总经理"</span><span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"批准"</span><span class="token operator">&lt;&lt;</span>name<span class="token operator">&lt;&lt;</span><span class="token string">"加薪"</span><span class="token operator">&lt;&lt;</span>num<span class="token operator">&lt;&lt;</span><span class="token string">"元"</span><span class="token operator">&lt;&lt;</span>endl<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#123;</span>     </pre></td></tr><tr><td data-num="61"></td><td><pre>    Manager <span class="token operator">*</span>general <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GeneralManager</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置上级，总经理没有上级  </span></pre></td></tr><tr><td data-num="62"></td><td><pre>    Manager <span class="token operator">*</span>majordomo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Majordomo</span><span class="token punctuation">(</span>general<span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置上级  </span></pre></td></tr><tr><td data-num="63"></td><td><pre>    Manager <span class="token operator">*</span>common <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CommonManager</span><span class="token punctuation">(</span>majordomo<span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置上级  </span></pre></td></tr><tr><td data-num="64"></td><td><pre>    common<span class="token operator">-></span><span class="token function">DealWithRequest</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 员工 D 要求加薪  </span></pre></td></tr><tr><td data-num="65"></td><td><pre>    common<span class="token operator">-></span><span class="token function">DealWithRequest</span><span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    common<span class="token operator">-></span><span class="token function">DealWithRequest</span><span class="token punctuation">(</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token keyword">delete</span> common<span class="token punctuation">;</span> <span class="token keyword">delete</span> majordomo<span class="token punctuation">;</span> <span class="token keyword">delete</span> general<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="命令no"><a class="anchor" href="#命令no">#</a> 命令 no</h2><p>&lt;br/&gt;</p><h2 id="迭代器no"><a class="anchor" href="#迭代器no">#</a> 迭代器 no</h2><p>&lt;br/&gt;</p><h2 id="中介者"><a class="anchor" href="#中介者">#</a> 中介者</h2><p>中介者模式：用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p><p><img data-src="ff93034551aa5a0ec52f8d0a382a704b.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Mediator</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 抽象人  </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    Mediator <span class="token operator">*</span>m_mediator<span class="token punctuation">;</span> <span class="token comment">// 中介  </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetMediator</span><span class="token punctuation">(</span>Mediator <span class="token operator">*</span>mediator<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// 设置中介  </span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment">// 向中介发送信息  </span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">GetMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>     <span class="token comment">// 从中介获取信息  </span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 抽象中介机构  </span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Mediator</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Person <span class="token operator">*</span>person<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetA</span><span class="token punctuation">(</span>Person <span class="token operator">*</span>A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  <span class="token comment">// 设置其中一方  </span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetB</span><span class="token punctuation">(</span>Person <span class="token operator">*</span>B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 租房者  </span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Renter</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetMediator</span><span class="token punctuation">(</span>Mediator <span class="token operator">*</span>mediator<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_mediator <span class="token operator">=</span> mediator<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_mediator<span class="token operator">-></span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">GetMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"租房者收到信息"</span><span class="token operator">&lt;&lt;</span>message<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 房东  </span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Landlord</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>  </pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetMediator</span><span class="token punctuation">(</span>Mediator <span class="token operator">*</span>mediator<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_mediator <span class="token operator">=</span> mediator<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SendMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_mediator<span class="token operator">-></span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">GetMessage</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"房东收到信息："</span><span class="token operator">&lt;&lt;</span>message<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// 房屋中介  </span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">HouseMediator</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Mediator</span></span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    Person <span class="token operator">*</span>m_A<span class="token punctuation">;</span> <span class="token comment">// 租房者  </span></pre></td></tr><tr><td data-num="41"></td><td><pre>    Person <span class="token operator">*</span>m_B<span class="token punctuation">;</span> <span class="token comment">// 房东  </span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token function">HouseMediator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetA</span><span class="token punctuation">(</span>Person <span class="token operator">*</span>A<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_A <span class="token operator">=</span> A<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetB</span><span class="token punctuation">(</span>Person <span class="token operator">*</span>B<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_B <span class="token operator">=</span> B<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Person <span class="token operator">*</span>person<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>person <span class="token operator">==</span> m_A<span class="token punctuation">)</span> <span class="token comment">// 租房者给房东发信息  </span></pre></td></tr><tr><td data-num="49"></td><td><pre>            m_B<span class="token operator">-></span><span class="token function">GetMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 房东收到信息  </span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>            m_A<span class="token operator">-></span><span class="token function">GetMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">&#123;</span>     </pre></td></tr><tr><td data-num="58"></td><td><pre>    Mediator <span class="token operator">*</span>mediator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">HouseMediator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre>    Person <span class="token operator">*</span>person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Renter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 租房者  </span></pre></td></tr><tr><td data-num="60"></td><td><pre>    Person <span class="token operator">*</span>person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Landlord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 房东  </span></pre></td></tr><tr><td data-num="61"></td><td><pre>    mediator<span class="token operator">-></span><span class="token function">SetA</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>    mediator<span class="token operator">-></span><span class="token function">SetB</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>    person1<span class="token operator">-></span><span class="token function">SetMediator</span><span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre>    person2<span class="token operator">-></span><span class="token function">SetMediator</span><span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre>    person1<span class="token operator">-></span><span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token string">"我想在南京路附近租套房子，价格800元一个月\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    person2<span class="token operator">-></span><span class="token function">SendMessage</span><span class="token punctuation">(</span><span class="token string">"出租房子：南京路100号，70平米，1000元一个月\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token keyword">delete</span> person1<span class="token punctuation">;</span> <span class="token keyword">delete</span> person2<span class="token punctuation">;</span> <span class="token keyword">delete</span> mediator<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="备忘录"><a class="anchor" href="#备忘录">#</a> 备忘录</h2><p>备忘录模式：在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。</p><p>举个简单的例子，我们玩游戏时都会保存进度，所保存的进度以文件的形式存在。这样下次就可以继续玩，而不用从头开始。这里的进度其实就是游戏的内部状态，而这里的文件相当于是在游戏之外保存状态。这样，下次就可以从文件中读入保存的进度，从而恢复到原来的状态。这就是备忘录模式</p><p><img data-src="f68dfc75dd4ad266d7b09195482cd347.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 需保存的信息  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Memento</span>    </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">int</span> m_vitality<span class="token punctuation">;</span> <span class="token comment">// 生命值  </span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">int</span> m_attack<span class="token punctuation">;</span>   <span class="token comment">// 进攻值  </span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">int</span> m_defense<span class="token punctuation">;</span>  <span class="token comment">// 防守值  </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token function">Memento</span><span class="token punctuation">(</span><span class="token keyword">int</span> vitality<span class="token punctuation">,</span> <span class="token keyword">int</span> attack<span class="token punctuation">,</span> <span class="token keyword">int</span> defense<span class="token punctuation">)</span><span class="token operator">:</span>   </pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token function">m_vitality</span><span class="token punctuation">(</span>vitality<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_attack</span><span class="token punctuation">(</span>attack<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_defense</span><span class="token punctuation">(</span>defense<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>    Memento<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Memento <span class="token operator">&amp;</span>memento<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>        m_vitality <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_vitality<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>        m_attack <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_attack<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>        m_defense <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_defense<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// 游戏角色  </span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">GameRole</span>    </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">int</span> m_vitality<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">int</span> m_attack<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">int</span> m_defense<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token function">GameRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_vitality</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_attack</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">m_defense</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    Memento <span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 保存进度，只与 Memento 对象交互，并不牵涉到 Caretake  </span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#123;</span>   </pre></td></tr><tr><td data-num="30"></td><td><pre>        Memento <span class="token function">memento</span><span class="token punctuation">(</span>m_vitality<span class="token punctuation">,</span> m_attack<span class="token punctuation">,</span> m_defense<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">return</span> memento<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Load</span><span class="token punctuation">(</span>Memento memento<span class="token punctuation">)</span>  <span class="token comment">// 载入进度，只与 Memento 对象交互，并不牵涉到 Caretake  </span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>        m_vitality <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_vitality<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>        m_attack <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_attack<span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="37"></td><td><pre>        m_defense <span class="token operator">=</span> memento<span class="token punctuation">.</span>m_defense<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"vitality : "</span><span class="token operator">&lt;&lt;</span> m_vitality<span class="token operator">&lt;&lt;</span><span class="token string">", attack : "</span><span class="token operator">&lt;&lt;</span> m_attack<span class="token operator">&lt;&lt;</span><span class="token string">", defense : "</span><span class="token operator">&lt;&lt;</span> m_defense<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_vitality <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span> m_attack <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>  m_defense <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token comment">// 保存的进度库  </span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Caretake</span>    </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token function">Caretake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Save</span><span class="token punctuation">(</span>Memento menento<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_vecMemento<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>menento<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>    Memento <span class="token function">Load</span><span class="token punctuation">(</span><span class="token keyword">int</span> state<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> m_vecMemento<span class="token punctuation">[</span>state<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    vector<span class="token operator">&lt;</span>Memento<span class="token operator">></span> m_vecMemento<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#123;</span>     </pre></td></tr><tr><td data-num="56"></td><td><pre>    Caretake caretake<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="57"></td><td><pre>    GameRole role<span class="token punctuation">;</span>   </pre></td></tr><tr><td data-num="58"></td><td><pre>    role<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 初始值  </span></pre></td></tr><tr><td data-num="59"></td><td><pre>    caretake<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>role<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 保存状态  </span></pre></td></tr><tr><td data-num="60"></td><td><pre>    role<span class="token punctuation">.</span><span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     </pre></td></tr><tr><td data-num="61"></td><td><pre>    role<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 进攻后  </span></pre></td></tr><tr><td data-num="62"></td><td><pre>    role<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span>caretake<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 载入状态   </span></pre></td></tr><tr><td data-num="63"></td><td><pre>    role<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 恢复到状态 0  </span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="观察者"><a class="anchor" href="#观察者">#</a> 观察者</h2><p>观察者模式：定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。它还有两个别名，依赖 (Dependents)，发布 - 订阅 (Publish-Subsrcibe)。</p><p>可以举个博客订阅的例子，当博主发表新文章的时候，即博主状态发生了改变，那些订阅的读者就会收到通知，然后进行相应的动作，比如去看文章，或者收藏起来。博主与读者之间存在种一对多的依赖关系。</p><p><img data-src="64d49c14e61a756a05645b122b6f044a.png" alt="截图"></p><p>可以看到博客类中有一个观察者链表（即订阅者），当博客的状态发生变化时，通过 Notify 成员函数通知所有的观察者，告诉他们博客的状态更新了。而观察者通过 Update 成员函数获取博客的状态信息。</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 观察者  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Observer</span>    </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 博客  </span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Blog</span>    </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function">Blog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Blog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Observer <span class="token operator">*</span>observer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_observers<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>     <span class="token comment">// 添加观察者  </span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Remove</span><span class="token punctuation">(</span>Observer <span class="token operator">*</span>observer<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_observers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>        <span class="token comment">// 移除观察者  </span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 通知观察者  </span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>        list<span class="token operator">&lt;</span>Observer<span class="token operator">*</span><span class="token operator">></span><span class="token double-colon punctuation">::</span>iterator iter <span class="token operator">=</span> m_observers<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> iter <span class="token operator">!=</span> m_observers<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iter<span class="token operator">++</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token punctuation">(</span><span class="token operator">*</span>iter<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetStatus</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_status <span class="token operator">=</span> s<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 设置状态  </span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">virtual</span> string <span class="token function">GetStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> m_status<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token comment">// 获得状态  </span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    list<span class="token operator">&lt;</span>Observer<span class="token operator">*</span> <span class="token operator">></span> m_observers<span class="token punctuation">;</span> <span class="token comment">// 观察者链表  </span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    string m_status<span class="token punctuation">;</span> <span class="token comment">// 状态  </span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">// 具体博客类  </span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">BlogCSDN</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Blog</span></span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    string m_name<span class="token punctuation">;</span> <span class="token comment">// 博主名称  </span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token function">BlogCSDN</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token operator">~</span><span class="token function">BlogCSDN</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetStatus</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_status <span class="token operator">=</span> <span class="token string">"CSDN通知 : "</span> <span class="token operator">+</span> m_name <span class="token operator">+</span> s<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// 具体设置状态信息  </span></pre></td></tr><tr><td data-num="40"></td><td><pre>    string <span class="token function">GetStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> m_status<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token comment">// 具体观察者  </span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ObserverBlog</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Observer</span></span>     </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>    string m_name<span class="token punctuation">;</span>  <span class="token comment">// 观察者名称  </span></pre></td></tr><tr><td data-num="47"></td><td><pre>    Blog <span class="token operator">*</span>m_blog<span class="token punctuation">;</span>   <span class="token comment">// 观察的博客，当然以链表形式更好，就可以观察多个博客  </span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>   </pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token function">ObserverBlog</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span>Blog <span class="token operator">*</span>blog<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_blog</span><span class="token punctuation">(</span>blog<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token operator">~</span><span class="token function">ObserverBlog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 获得更新状态  </span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#123;</span>   </pre></td></tr><tr><td data-num="53"></td><td><pre>        string status <span class="token operator">=</span> m_blog<span class="token operator">-></span><span class="token function">GetStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="54"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span>m_name<span class="token operator">&lt;&lt;</span><span class="token string">"-------"</span><span class="token operator">&lt;&lt;</span>status<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre>    Blog <span class="token operator">*</span>blog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BlogCSDN</span><span class="token punctuation">(</span><span class="token string">"wuzhekai1985"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>    Observer <span class="token operator">*</span>observer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ObserverBlog</span><span class="token punctuation">(</span><span class="token string">"tutupig"</span><span class="token punctuation">,</span> blog<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>    blog<span class="token operator">-></span><span class="token function">Attach</span><span class="token punctuation">(</span>observer1<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre>    blog<span class="token operator">-></span><span class="token function">SetStatus</span><span class="token punctuation">(</span><span class="token string">"发布博客"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre>    blog<span class="token operator">-></span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token keyword">delete</span> blog<span class="token punctuation">;</span> <span class="token keyword">delete</span> observer1<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="状态"><a class="anchor" href="#状态">#</a> 状态</h2><p>状态模式：允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它的类。它有两种使用情况：（1）一个对象的行为取决于它的状态，并且它必须在运行时刻根据状态改变它的行为。（2）一个操作中含有庞大的多分支的条件语句，且这些分支依赖于该对象的状态。</p><p>以战争为例，假设一场战争需经历四个阶段：前期、中期、后期、结束。当战争处于不同的阶段，战争的行为是不一样的，也就说战争的行为取决于所处的阶段，而且随着时间的推进是动态变化的。</p><p><img data-src="b8c47cca7c7f4ad7a8a59743e488578b.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">War</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">State</span>   </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Prophase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Metaphase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Anaphase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">CurrentState</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 战争  </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">War</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre>    State <span class="token operator">*</span>m_state<span class="token punctuation">;</span>  <span class="token comment">// 目前状态  </span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">int</span> m_days<span class="token punctuation">;</span>      <span class="token comment">// 战争持续时间  </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">War</span><span class="token punctuation">(</span>State <span class="token operator">*</span>state<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_state</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_days</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token operator">~</span><span class="token function">War</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> m_state<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">int</span> <span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> m_days<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetDays</span><span class="token punctuation">(</span><span class="token keyword">int</span> days<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_days <span class="token operator">=</span> days<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetState</span><span class="token punctuation">(</span>State <span class="token operator">*</span>state<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> m_state<span class="token punctuation">;</span> m_state <span class="token operator">=</span> state<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">GetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_state<span class="token operator">-></span><span class="token function">CurrentState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 战争结束  </span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">EndState</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">State</span></span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">End</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token comment">// 结束阶段的具体行为  </span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>        cout<span class="token operator">&lt;&lt;</span><span class="token string">"战争结束"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">CurrentState</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">End</span><span class="token punctuation">(</span>war<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// 后期  </span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AnaphaseState</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">State</span></span>  </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Anaphase</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token comment">// 后期的具体行为  </span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"第"</span><span class="token operator">&lt;&lt;</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"天：战争后期，双方拼死一搏"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>            war<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">EndState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="47"></td><td><pre>            war<span class="token operator">-></span><span class="token function">GetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">CurrentState</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">Anaphase</span><span class="token punctuation">(</span>war<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment">// 中期  </span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MetaphaseState</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">State</span></span>  </pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Metaphase</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token comment">// 中期的具体行为  </span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="59"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"第"</span><span class="token operator">&lt;&lt;</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"天：战争中期，进入相持阶段，双发各有损耗"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="62"></td><td><pre>            war<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">AnaphaseState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="63"></td><td><pre>            war<span class="token operator">-></span><span class="token function">GetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">CurrentState</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">Metaphase</span><span class="token punctuation">(</span>war<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token comment">// 前期  </span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ProphaseState</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">State</span></span>  </pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Prophase</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span>  <span class="token comment">// 前期的具体行为  </span></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="74"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="75"></td><td><pre>            cout<span class="token operator">&lt;&lt;</span><span class="token string">"第"</span><span class="token operator">&lt;&lt;</span>war<span class="token operator">-></span><span class="token function">GetDays</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"天：战争初期，双方你来我往，互相试探对方"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token keyword">else</span>  </pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="78"></td><td><pre>            war<span class="token operator">-></span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">MetaphaseState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="79"></td><td><pre>            war<span class="token operator">-></span><span class="token function">GetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">CurrentState</span><span class="token punctuation">(</span>War <span class="token operator">*</span>war<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">Prophase</span><span class="token punctuation">(</span>war<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="88"></td><td><pre>    War <span class="token operator">*</span>war <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">War</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">ProphaseState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">;</span>i <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="91"></td><td><pre>        war<span class="token operator">-></span><span class="token function">SetDays</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="92"></td><td><pre>        war<span class="token operator">-></span><span class="token function">GetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">delete</span> war<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="策略"><a class="anchor" href="#策略">#</a> 策略</h2><p>策略模式是指定义一系列的算法，把它们一个个封装起来，并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。也就是说这些算法所完成的功能一样，对外的接口一样，只是各自实现上存在差异。</p><p><img data-src="ebc207bad40ecb66021a00e61b012d93.png" alt="截图"></p><p>指定替换算法的方式</p><ol><li>通过参数指定，在 Cache 构造函数中传入参数</li><li>利用模板实现，在生成 Cache 具体类的时候指定模板</li></ol><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 抽象接口  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ReplaceAlgorithm</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 三种具体的替换算法  </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">LRU_ReplaceAlgorithm</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">ReplaceAlgorithm</span></span>  </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Least Recently Used replace algorithm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>  </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FIFO_ReplaceAlgorithm</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">ReplaceAlgorithm</span></span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"First in First out replace algorithm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Random_ReplaceAlgorithm</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">ReplaceAlgorithm</span></span>  </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"Random replace algorithm"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//Cache 需要用到替换算法  </span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">enum</span> <span class="token class-name">RA</span> <span class="token punctuation">&#123;</span>LRU<span class="token punctuation">,</span> FIFO<span class="token punctuation">,</span> RANDOM<span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// 标签  </span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Cache</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre>    ReplaceAlgorithm <span class="token operator">*</span>m_ra<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token function">Cache</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">RA</span> ra<span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#123;</span>   </pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>ra <span class="token operator">==</span> LRU<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>            m_ra <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">LRU_ReplaceAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ra <span class="token operator">==</span> FIFO<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>            m_ra <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">FIFO_ReplaceAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ra <span class="token operator">==</span> RANDOM<span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>            m_ra <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Random_ReplaceAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">else</span>   </pre></td></tr><tr><td data-num="41"></td><td><pre>            m_ra <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token operator">~</span><span class="token function">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">delete</span> m_ra<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> m_ra<span class="token operator">-></span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="50"></td><td><pre>    Cache <span class="token function">cache</span><span class="token punctuation">(</span>LRU<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 指定标签即可  </span></pre></td></tr><tr><td data-num="51"></td><td><pre>    cache<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="模板方法"><a class="anchor" href="#模板方法">#</a> 模板方法</h2><p>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p><p><img data-src="593d58c7de3c3d9a1d528bc08e268d53.png" alt="截图"></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 简历  </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Resume</span>  </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span> <span class="token comment">// 保护成员  </span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">SetWorkExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">FillResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   </pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token function">SetEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token function">SetWorkExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ResumeA</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Resume</span></span>  </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"A's PersonalInfo"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"A's Education"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetWorkExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"A's Work Experience"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ResumeB</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Resume</span></span>  </pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span>  </pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetPersonalInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"B's PersonalInfo"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetEducation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"B's Education"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SetWorkExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout<span class="token operator">&lt;&lt;</span><span class="token string">"B's Work Experience"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">// 客户</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#123;</span>  </pre></td></tr><tr><td data-num="34"></td><td><pre>    Resume <span class="token operator">*</span>r1<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="35"></td><td><pre>    r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ResumeA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="36"></td><td><pre>    r1<span class="token operator">-></span><span class="token function">FillResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">delete</span> r1<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="38"></td><td><pre>    r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ResumeB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="39"></td><td><pre>    r1<span class="token operator">-></span><span class="token function">FillResume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">delete</span> r1<span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="41"></td><td><pre>    r1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="访问者no"><a class="anchor" href="#访问者no">#</a> 访问者 no</h2><div class="tags"><a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag"><i class="ic i-tag"></i> 设计模式</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-09-15 15:17:39" itemprop="dateModified" datetime="2023-09-15T15:17:39+08:00">2023-09-15</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Umi <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="http://lovearrowshoot.github.io/DP/DP/" title="设计模式详解">http://lovearrowshoot.github.io/DP/DP/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/hexo/hexo/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;umi-blog-delta.vercel.app&#x2F;gh&#x2F;LoveArrowShoot&#x2F;image-bed@main&#x2F;blog-img&#x2F;712UR-Minami-Kotori-Ehehe-Flexibility-Is-My-Forte-An-Elegant-Night-Party-IDPVyI.png" title="Hexo-Shoka主题的配置和使用"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Hexo</span><h3>Hexo-Shoka主题的配置和使用</h3></a></div><div class="item right"><a href="/hexo/hexo-fullscreen/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;umi-blog-delta.vercel.app&#x2F;gh&#x2F;LoveArrowShoot&#x2F;image-bed@main&#x2F;blog-img&#x2F;109Ayase-Eli-Will-you-wait-next-to-me-SR-mu72w7.png" title="Hexo-shoka自定义"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Hexo</span><h3>Hexo-shoka自定义</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="toc-number">1.</span> <span class="toc-text">六大原则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E5%8E%9F%E5%88%99%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99open-closed-principle"><span class="toc-number">1.0.1.</span> <span class="toc-text">总原则 —— 开闭原则（Open Closed Principle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99single-responsibility-principle"><span class="toc-number">1.0.2.</span> <span class="toc-text">1、单一职责原则（Single Responsibility Principle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99liskov-substitution-principle"><span class="toc-number">1.0.3.</span> <span class="toc-text">2、里氏替换原则（Liskov Substitution Principle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99dependence-inversion-principle"><span class="toc-number">1.0.4.</span> <span class="toc-text">3、依赖倒置原则（Dependence Inversion Principle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99interface-segregation-principle"><span class="toc-number">1.0.5.</span> <span class="toc-text">4、接口隔离原则（Interface Segregation Principle）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99%E6%9C%80%E5%B0%91%E7%9F%A5%E9%81%93%E5%8E%9F%E5%88%99law-of-demeter"><span class="toc-number">1.0.6.</span> <span class="toc-text">5、迪米特法则（最少知道原则）(Law of Demeter)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99composite-reuse-principle"><span class="toc-number">1.0.7.</span> <span class="toc-text">6、合成复用原则（Composite Reuse Principle）</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">创建型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">工厂方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82"><span class="toc-number">2.2.</span> <span class="toc-text">抽象工厂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85"><span class="toc-number">2.3.</span> <span class="toc-text">建造者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B"><span class="toc-number">2.4.</span> <span class="toc-text">原型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B"><span class="toc-number">2.5.</span> <span class="toc-text">单例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">结构型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8"><span class="toc-number">3.1.</span> <span class="toc-text">适配器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%A5%E6%8E%A5"><span class="toc-number">3.2.</span> <span class="toc-text">桥接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88"><span class="toc-number">3.3.</span> <span class="toc-text">组合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0"><span class="toc-number">3.4.</span> <span class="toc-text">装饰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E8%A7%82"><span class="toc-number">3.5.</span> <span class="toc-text">外观</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%AB%E5%85%83"><span class="toc-number">3.6.</span> <span class="toc-text">享元</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86"><span class="toc-number">3.7.</span> <span class="toc-text">代理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.</span> <span class="toc-text">行为模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A3%E4%BB%BB%E9%93%BE"><span class="toc-number">4.1.</span> <span class="toc-text">责任链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4no"><span class="toc-number">4.2.</span> <span class="toc-text">命令 no</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8no"><span class="toc-number">4.3.</span> <span class="toc-text">迭代器 no</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E4%BB%8B%E8%80%85"><span class="toc-number">4.4.</span> <span class="toc-text">中介者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95"><span class="toc-number">4.5.</span> <span class="toc-text">备忘录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85"><span class="toc-number">4.6.</span> <span class="toc-text">观察者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81"><span class="toc-number">4.7.</span> <span class="toc-text">状态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%96%E7%95%A5"><span class="toc-number">4.8.</span> <span class="toc-text">策略</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95"><span class="toc-number">4.9.</span> <span class="toc-text">模板方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E8%80%85no"><span class="toc-number">4.10.</span> <span class="toc-text">访问者 no</span></a></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/DP/DP/" rel="bookmark" title="设计模式详解">设计模式详解</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Umi" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Umi</p><div class="description" itemprop="description">这只是我闲着无聊搭的一个博客，主要用于存放笔记，顺便厨力放出</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">10</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">6</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">6</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0xvdmVBcnJvd1Nob290" title="https:&#x2F;&#x2F;github.com&#x2F;LoveArrowShoot"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9seHgxNTkxMTA=" title="https:&#x2F;&#x2F;twitter.com&#x2F;lxx159110"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9tYXJ2ZWxmZw==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;marvelfg"><i class="ic i-zhihu"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>直达</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/hexo/hexo/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/hexo/hexo-fullscreen/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/DP/" title="分类于 设计模式">设计模式</a></div><span><a href="/DP/DP/" title="设计模式详解">设计模式详解</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Algorithms/" title="分类于 算法">算法</a></div><span><a href="/Algorithms/%E7%AE%97%E6%B3%95/" title="常见算法">常见算法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cpp/" title="分类于 C++">C++</a></div><span><a href="/cpp/C++11%E7%89%B9%E8%89%B2/" title="C++11特色">C++11特色</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Algorithms/" title="分类于 算法">算法</a></div><span><a href="/Algorithms/ACM/" title="ACM常用输入输出">ACM常用输入输出</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DB/" title="分类于 数据库">数据库</a></div><span><a href="/DB/MySQL/" title="MySQL">MySQL</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CS/" title="分类于 计算机科学">计算机科学</a></div><span><a href="/CS/OS/" title="操作系统">操作系统</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CS/" title="分类于 计算机科学">计算机科学</a></div><span><a href="/CS/CN/" title="计算机网络">计算机网络</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/DB/" title="分类于 数据库">数据库</a></div><span><a href="/DB/Redis/" title="Redis">Redis</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/hexo/" title="分类于 Hexo">Hexo</a></div><span><a href="/hexo/hexo/" title="Hexo-Shoka主题的配置和使用">Hexo-Shoka主题的配置和使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/hexo/" title="分类于 Hexo">Hexo</a></div><span><a href="/hexo/hexo-fullscreen/" title="Hexo-shoka自定义">Hexo-shoka自定义</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Umi @ umiの道場</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">65k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">59 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"DP/DP/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->